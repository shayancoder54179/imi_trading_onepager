<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>THE IMPROVE ME TRADING ACADEMY | GEMS Education x Improve ME Institute</title>
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Montserrat:wght@400;500;600&family=Lato:wght@400;700&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous">
  <style>
    /* ============================================
       CSS CUSTOM PROPERTIES - Theming
       ============================================ */
    :root {
      /* A4 Landscape: 297mm × 210mm */
      --a4-width: 297mm;
      --a4-height: 210mm;
      --page-margin: 10mm;
      --content-width: calc(var(--a4-width) - (2 * var(--page-margin)));
      --content-height: calc(var(--a4-height) - (2 * var(--page-margin)));
      --gems-blue: #0a1628;
      --gems-blue-print: #0d1f38;
      --gold: #D4AF37;
      --gold-light: #e5c65c;
      --charcoal: #3A3A3A;
      --charcoal-light: #4a4a4a;
      --white: #ffffff;
      --white-soft: rgba(255, 255, 255, 0.92);
      --serif: 'Playfair Display', Georgia, serif;
      --sans: 'Montserrat', 'Lato', -apple-system, sans-serif;
    }

    /* ============================================
       RESET & BASE
       ============================================ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    html, body {
      height: 100%;
      overflow: hidden;
      font-family: var(--sans);
      font-size: 3.9mm; /* +~20% base */
      line-height: 1.6; /* min 1.5 for readability */
      color: var(--white-soft);
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }

    /* ============================================
       A4 LANDSCAPE PAGE - Fixed dimensions
       ============================================ */
    .page-container {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      min-height: 100dvh;
      background: #1a1a2e;
      padding: 8px;
      overflow: hidden;
      position: relative;
    }

    .download-pdf-btn {
      position: fixed;
      top: 16px;
      right: 16px;
      z-index: 1000;
      padding: 10px 20px;
      font-family: var(--sans);
      font-size: 16px;
      font-weight: 600;
      color: var(--gems-blue);
      background: var(--gold);
      border: none;
      border-radius: 6px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      display: flex;
      align-items: center;
      gap: 8px;
      transition: background 0.2s, transform 0.2s;
    }

    .download-pdf-btn:hover {
      background: var(--gold-light);
      transform: translateY(-1px);
    }

    .download-pdf-btn:active {
      transform: translateY(0);
    }

    .download-pdf-btn i {
      font-size: 16px;
    }

    .page-scaler {
      transform-origin: center center;
      flex-shrink: 0;
    }

    /* Content area = exact A4 landscape (297mm × 210mm) for PDF export */
    .page {
      width: var(--a4-width);
      height: var(--a4-height);
      max-width: 100%;
      max-height: calc(100vh - 16px);
      max-height: calc(100dvh - 16px);
      background: var(--gems-blue);
      position: relative;
      overflow: hidden;
      display: grid;
      grid-template-rows: auto auto 1fr;
      grid-template-columns: 1fr;
      gap: 0;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      padding: 6mm var(--page-margin) 8mm;
    }

    .page > * { position: relative; z-index: 1; }

    /* ============================================
       HEADER - Full width (compact)
       ============================================ */
    .header {
      display: grid;
      grid-template-columns: auto 1fr;
      grid-template-rows: 1fr;
      align-items: center;
      gap: 3mm;
      padding: 0 0 1.5mm;
      border-bottom: 1px solid rgba(212, 175, 55, 0.2);
    }

    .logos {
      display: flex;
      align-items: center;
      gap: 16px;
      flex-shrink: 0;
    }

    .logo-placeholder {
      width: 30mm;
      height: 14mm;
      min-width: 30mm;
      min-height: 14mm;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--white);
      overflow: hidden;
    }

    .logo-placeholder img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
      object-fit: contain;
      object-position: center;
      image-rendering: high-quality;
      image-rendering: -webkit-optimize-contrast;
    }

    .logo-placeholder.wide {
      width: 32mm;
      height: 14mm;
      min-width: 32mm;
      min-height: 14mm;
    }

    .logo-placeholder.wide img {
      max-width: 100%;
      max-height: 100%;
      width: auto;
      height: auto;
    }

    .header-content {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      justify-content: center;
      text-align: right;
    }

    .headline {
      font-family: var(--serif);
      font-weight: 700;
      font-size: 6.5mm;
      letter-spacing: 0.06em;
      color: var(--gold);
    }

    .subheadline {
      font-family: var(--sans);
      font-size: 2.6mm;
      font-weight: 500;
      letter-spacing: 0.03em;
      color: rgba(255, 255, 255, 0.9);
      margin-top: 0.2mm;
    }

    /* ----- STATS STRIP (horizontal badges below header) ----- */
    .stats-strip {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1.5mm 2.5mm;
      padding: 1.5mm 0 2mm;
      border-bottom: 1px solid rgba(212, 175, 55, 0.2);
    }

    .stat-badge {
      display: inline-flex;
      align-items: center;
      gap: 1mm;
      padding: 1mm 2.5mm;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(212, 175, 55, 0.35);
      border-radius: 20px;
      font-size: 2.8mm;
      color: var(--white-soft);
      font-weight: 500;
    }

    .stat-badge i {
      color: var(--gold);
      font-size: 3.2mm;
    }

    /* ============================================
       BODY - Full width main
       ============================================ */
    .body {
      flex: 1;
      min-height: 0;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    /* ----- MAIN CONTENT ----- */
    .main {
      padding: 2mm 4mm 0;
      display: flex;
      flex-direction: column;
      gap: 2mm;
      flex: 1;
      min-height: 0;
      overflow: hidden;
    }

    .main-grid {
      display: flex;
      flex-direction: column;
      gap: 2mm;
      flex: 1;
      min-height: 0;
    }

    /* ----- INSTRUCTOR SECTION (Shaun Daswani) - Compact ----- */
    .founder-section {
      display: grid;
      grid-template-columns: 26mm 1fr;
      gap: 3mm;
      align-items: center;
      padding: 2.5mm 3mm;
      border: 2px solid var(--gold);
      border-radius: 2mm;
      background: rgba(0, 0, 0, 0.35);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    .headshot-placeholder {
      width: 26mm;
      height: 26mm;
      min-width: 26mm;
      min-height: 26mm;
      border-radius: 2mm;
      overflow: hidden;
      flex-shrink: 0;
      border: 1px solid rgba(212, 175, 55, 0.5);
    }

    .headshot-placeholder img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .founder-content h3 {
      font-family: var(--serif);
      font-size: 4mm;
      font-weight: 600;
      color: var(--gold);
      margin-bottom: 0.5mm;
    }

    .founder-content .labels {
      font-size: 2.7mm;
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 0.5mm;
      font-style: italic;
    }

    .founder-content .vision-text {
      font-size: 2.9mm;
      color: var(--white-soft);
      line-height: 1.5;
    }

    /* ----- Tech/Leap/Financials - Two-row layout ----- */
    .supporting-boxes {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 3mm;
    }

    .content-box {
      padding: 2mm 3mm;
      background: rgba(255, 255, 255, 0.95);
      color: #1a1a2e;
      border-radius: 2mm;
      font-size: 2.8mm;
      line-height: 1.45;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(212, 175, 55, 0.3);
    }

    .content-box strong { color: #0a1628; }

    /* ----- ECOSYSTEM SYNERGY - Compact flowchart ----- */
    .ecosystem-section {
      padding: 1.5mm 0;
      display: flex;
      flex-direction: column;
      gap: 1.5mm;
    }

    .ecosystem-title {
      font-family: var(--serif);
      font-size: 3.5mm;
      font-weight: 600;
      color: var(--gold);
      letter-spacing: 0.06em;
    }

    .ecosystem-flow {
      display: grid;
      grid-template-columns: 1fr auto 1fr auto 1fr;
      align-items: stretch;
      gap: 3mm;
      font-size: 2.8mm;
    }

    .flow-step {
      background: linear-gradient(180deg, rgba(255,255,255,0.12) 0%, rgba(0,0,0,0.3) 100%);
      border: 2px solid rgba(212, 175, 55, 0.5);
      border-radius: 2mm;
      padding: 2mm 3mm;
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 2mm;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .flow-step .step-icon {
      font-size: 4.5mm;
      color: var(--gold);
      flex-shrink: 0;
    }

    .flow-step .step-content {
      display: flex;
      flex-direction: column;
      gap: 0.3mm;
      flex: 1;
      min-width: 0;
    }

    .flow-step .step-header {
      display: flex;
      align-items: baseline;
      gap: 1mm;
    }

    .flow-step .step-num {
      font-weight: 700;
      font-size: 2.4mm;
      color: var(--gold);
    }

    .flow-step .step-title {
      font-weight: 700;
      font-size: 3mm;
      color: var(--white);
    }
    .flow-step .step-desc {
      color: rgba(255, 255, 255, 0.85);
      font-size: 2.5mm;
    }

    .flow-arrow {
      color: var(--gold);
      font-size: 5mm;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ----- CURRICULUM ROADMAP - Compact cards ----- */
    .curriculum-section {
      padding: 1mm 0;
      display: flex;
      flex-direction: column;
      gap: 1.5mm;
    }

    .curriculum-title {
      font-family: var(--serif);
      font-size: 3.5mm;
      font-weight: 600;
      color: var(--gold);
      letter-spacing: 0.06em;
    }

    .curriculum-steps {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 2.5mm;
    }

    .curriculum-step {
      background: linear-gradient(180deg, rgba(212, 175, 55, 0.18) 0%, rgba(0, 0, 0, 0.25) 100%);
      border: 2px solid rgba(212, 175, 55, 0.45);
      border-radius: 2mm;
      padding: 2mm 3mm;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 0.5mm;
    }

    .curriculum-step:nth-child(1) { border-left: 4px solid rgba(212, 175, 55, 0.8); }
    .curriculum-step:nth-child(2) { border-left: 4px solid rgba(212, 175, 55, 0.6); }
    .curriculum-step:nth-child(3) { border-left: 4px solid var(--gold); }

    .curriculum-step .level {
      font-weight: 700;
      font-size: 3.2mm;
      color: var(--gold);
    }

    .curriculum-step .topic {
      font-size: 2.8mm;
      color: var(--white-soft);
      line-height: 1.4;
    }

    .curriculum-step .greeks {
      font-size: 3.2mm;
      color: var(--gold);
      letter-spacing: 0.06em;
      font-weight: 700;
    }

    /* ----- REVENUE SECTION - Compact hero numbers ----- */
    .impact-section {
      padding: 1mm 0 0;
      display: flex;
      flex-direction: column;
      gap: 1.5mm;
    }

    .impact-section .section-label {
      font-family: var(--serif);
      font-size: 3.5mm;
      font-weight: 600;
      color: var(--gold);
      letter-spacing: 0.06em;
    }

    .impact-section .impact-cards {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 2.5mm;
    }

    .impact-section .impact-card {
      background: #ffffff;
      border: 2px solid var(--gold);
      border-radius: 2mm;
      padding: 2.5mm 3mm;
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 2mm;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }

    .impact-section .impact-card .growth-icon {
      color: #22c55e;
      font-size: 6mm;
      flex-shrink: 0;
    }

    .impact-section .impact-card .impact-card-content {
      display: flex;
      flex-direction: column;
      gap: 0.3mm;
      flex: 1;
      min-width: 0;
    }

    .impact-section .impact-card .amount {
      font-family: var(--serif);
      font-size: 8mm;
      font-weight: 700;
      color: #0a1628;
      line-height: 1.1;
    }

    .impact-section .impact-card .label {
      font-size: 2.5mm;
      color: #333;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      line-height: 1.3;
    }

    /* ----- FOOTER - Contact & CTA ----- */
    .page-footer {
      flex-shrink: 0;
      margin-top: auto;
      padding: 2.5mm 0 0;
      border-top: 1px solid rgba(212, 175, 55, 0.2);
      text-align: center;
      font-size: 2.6mm;
      color: rgba(255, 255, 255, 0.85);
      letter-spacing: 0.02em;
    }

    .page-footer a {
      color: var(--gold);
      text-decoration: none;
      font-weight: 500;
    }

    .page-footer a:hover {
      text-decoration: underline;
    }

    .page-footer .separator {
      margin: 0 1.5mm;
      color: rgba(212, 175, 55, 0.5);
    }

    /* ============================================
       SCREEN: Scale page to fit viewport
       ============================================ */
    @media screen {
      .page {
        transform-origin: center center;
      }
    }

    /* ============================================
       PRINT STYLES
       ============================================ */
    @page {
      size: 297mm 210mm landscape;
      margin: 0;
    }

    @media print {
      html, body {
        overflow: visible;
        height: auto;
        background: white;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }

      .download-pdf-btn { display: none !important; }

      .page-container {
        min-height: 0;
        padding: 0;
        background: none;
        display: block;
      }

      .page {
        width: var(--a4-width) !important;
        height: var(--a4-height) !important;
        min-height: var(--a4-height);
        max-width: none;
        max-height: none;
        transform: none !important;
        box-shadow: none;
        margin: 0;
        padding: var(--page-margin);
        background: var(--gems-blue-print);
      }

      /* Ensure no page break inside */
      .page {
        page-break-after: avoid;
        page-break-inside: avoid;
      }

      .header, .body, .page-footer {
        page-break-inside: avoid;
      }
    }
  </style>
  <!-- html2pdf.js for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" crossorigin="anonymous"></script>
</head>
<body>
  <button type="button" class="download-pdf-btn" id="download-pdf-btn" title="Download as PDF (A4 Landscape)">
    <i class="fa-solid fa-file-pdf"></i> Download PDF
  </button>
  <div class="page-container">
    <div class="page-scaler" id="page-scaler">
    <div class="page">
      <!-- ========== HEADER ========== -->
      <header class="header">
        <div class="logos">
          <div class="logo-placeholder">
            <img src="img/For Videos.png" alt="Improve ME Trading Academy Logo">
          </div>
          <div class="logo-placeholder wide">
            <img src="img/GEMS-EDUCATION-Logo-Vector.svg-.png" alt="GEMS Education Logo">
          </div>
        </div>
        <div class="header-content">
          <h1 class="headline">THE IMPROVE ME TRADING ACADEMY</h1>
          <p class="subheadline">A Strategic GEMS Education x Improve ME Institute Initiative</p>
        </div>
      </header>

      <!-- ========== STATS STRIP ========== -->
      <div class="stats-strip">
        <span class="stat-badge"><i class="fa-solid fa-users"></i> 1,000+ Students</span>
        <span class="stat-badge"><i class="fa-solid fa-graduation-cap"></i> 40+ Educators</span>
        <span class="stat-badge"><i class="fa-solid fa-award"></i> GEMS Rewards Partner</span>
        <span class="stat-badge"><i class="fa-solid fa-dollar-sign"></i> Zero CapEx</span>
        <span class="stat-badge"><i class="fa-solid fa-laptop"></i> Powered by IBKR</span>
      </div>

      <!-- ========== BODY: Main Content ========== -->
      <div class="body">
        <main class="main">
          <div class="main-grid">
            <!-- Founder / Vision -->
            <section class="founder-section" aria-label="Founder profile">
              <div class="headshot-placeholder">
                <img src="img/WhatsApp Image 2026-02-15 at 17.16.05.jpeg" alt="Shaun Daswani, Founder">
              </div>
              <div class="founder-content">
                <h3>The GEMS Journey: Led by Shaun Daswani</h3>
                <p class="labels">Jumeirah College (JC) Alumnus | MSc Mathematical Finance (Imperial) | Ex-Morgan Stanley Trader</p>
                <p class="vision-text">Ex-Morgan Stanley trader and JC Alumnus returning to bridge the gap between classroom theory and elite market practice.</p>
              </div>
            </section>

            <!-- Technology, Leap, Financials boxes -->
            <div class="supporting-boxes">
              <div class="content-box">
                <strong>Technology.</strong> Utilizing the Interactive Brokers (IBKR) Trader Workstation—the gold standard used by institutional professionals.
              </div>
              <div class="content-box">
                <strong>Leap Integration.</strong> Transforming GEMS Leap from a pocket-money tool to a sophisticated wealth management instrument.
              </div>
              <div class="content-box">
                <strong>Financials.</strong> Zero CapEx: High-margin ancillary revenue with zero internal staffing burden for GEMS.
              </div>
            </div>

            <!-- Ecosystem Synergy - Large flowchart -->
            <section class="ecosystem-section" aria-label="Ecosystem synergy">
              <h3 class="ecosystem-title">Ecosystem Synergy</h3>
              <div class="ecosystem-flow">
                <div class="flow-step">
                  <i class="fa-solid fa-desktop step-icon" aria-hidden="true"></i>
                  <div class="step-content">
                    <div class="step-header">
                      <span class="step-num">Step 1</span>
                      <span class="step-title">IBKR TERMINAL</span>
                    </div>
                    <div class="step-desc">Simulation of $1M Portfolio</div>
                  </div>
                </div>
                <span class="flow-arrow" aria-hidden="true"><i class="fa-solid fa-chevron-right"></i></span>
                <div class="flow-step">
                  <i class="fa-solid fa-graduation-cap step-icon" aria-hidden="true"></i>
                  <div class="step-content">
                    <div class="step-header">
                      <span class="step-num">Step 2</span>
                      <span class="step-title">ACADEMY LEARNING</span>
                    </div>
                    <div class="step-desc">Instruction by Shaun Daswani & Faculty</div>
                  </div>
                </div>
                <span class="flow-arrow" aria-hidden="true"><i class="fa-solid fa-chevron-right"></i></span>
                <div class="flow-step">
                  <i class="fa-solid fa-wallet step-icon" aria-hidden="true"></i>
                  <div class="step-content">
                    <div class="step-header">
                      <span class="step-num">Step 3</span>
                      <span class="step-title">GEMS LEAP</span>
                    </div>
                    <div class="step-desc">Performance rewards deposited to student app</div>
                  </div>
                </div>
              </div>
            </section>

            <!-- Curriculum Roadmap -->
            <section class="curriculum-section" aria-label="Curriculum roadmap">
              <h3 class="curriculum-title">Curriculum Roadmap</h3>
              <div class="curriculum-steps">
                <div class="curriculum-step">
                  <div class="level">Level 01 — Foundations</div>
                  <div class="topic">Stock Mechanics & Global Exchanges</div>
                </div>
                <div class="curriculum-step">
                  <div class="level">Level 02 — Practitioner</div>
                  <div class="topic">Technical Analysis & ESG Metrics</div>
                </div>
                <div class="curriculum-step">
                  <div class="level">Level 03 — Elite Analyst</div>
                  <div class="topic">Derivatives & The Greeks</div>
                  <div class="greeks">Δ (Delta) · Γ (Gamma) · Θ (Theta) · ν (Vega)</div>
                </div>
              </div>
            </section>

            <!-- Impact / Revenue cards - HERO SECTION -->
            <section class="impact-section" aria-label="Financial impact">
              <h3 class="section-label">Revenue Impact</h3>
              <div class="impact-cards">
                <div class="impact-card">
                  <i class="fa-solid fa-coins growth-icon" aria-hidden="true"></i>
                  <div class="impact-card-content">
                    <div class="amount">AED 3,000,000</div>
                    <div class="label">Pilot Revenue (Gross Annual)</div>
                  </div>
                </div>
                <div class="impact-card">
                  <i class="fa-solid fa-chart-line growth-icon" aria-hidden="true"></i>
                  <div class="impact-card-content">
                    <div class="amount">AED 1,200,000</div>
                    <div class="label">GEMS Net Profit (40% Share — Passive)</div>
                  </div>
                </div>
                <div class="impact-card">
                  <i class="fa-solid fa-arrow-trend-up growth-icon" aria-hidden="true"></i>
                  <div class="impact-card-content">
                    <div class="amount">AED 6,000,000+</div>
                    <div class="label">Network Potential (Full Scalability)</div>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </main>

        <!-- ========== FOOTER ========== -->
        <footer class="page-footer" aria-label="Contact and links">
          Contact us at <a href="mailto:shaun@academe.ae">shaun@academe.ae</a><span class="separator">|</span>Visit: <a href="https://improvemeinstitute.com" target="_blank" rel="noopener">improvemeinstitute.com</a>
        </footer>
      </div>
    </div>
    </div>
  </div>

  <script>
    // Scale page to fit viewport on screen
    (function() {
      function fitPage() {
        var page = document.querySelector('.page');
        if (!page || window.matchMedia('print').matches) return;
        var vw = window.innerWidth;
        var vh = window.innerHeight;
        var pageW = 1123;
        var pageH = 794;
        var scale = Math.min(vw / pageW, vh / pageH, 1);
        page.style.transform = scale < 1 ? 'scale(' + scale + ')' : 'none';
      }
      window.addEventListener('resize', fitPage);
      fitPage();
    })();

    // Wait for all images in element to load and decode (ensures crisp export)
    function whenImagesLoaded(el) {
      var imgs = el.querySelectorAll('img');
      if (imgs.length === 0) return Promise.resolve();
      return Promise.all(Array.from(imgs).map(function(img) {
        return new Promise(function(resolve) {
          function done() {
            if (img.decode) img.decode().then(resolve).catch(resolve);
            else resolve();
          }
          if (!img.complete) {
            img.onload = done;
            img.onerror = resolve;
            setTimeout(resolve, 3000);
          } else {
            done();
          }
        });
      }));
    }

    // Download PDF button - direct download, A4 landscape, correct content
    document.getElementById('download-pdf-btn').addEventListener('click', function() {
      var btn = this;
      var page = document.querySelector('.page');
      if (!page || typeof html2pdf === 'undefined') return;

      btn.disabled = true;
      btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Generating...';

      var savedTransform = page.style.transform;
      var savedMaxWidth = page.style.maxWidth;
      var savedMaxHeight = page.style.maxHeight;
      var container = document.querySelector('.page-container');
      var savedContainerOverflow = container ? container.style.overflow : '';
      page.style.transform = 'none';
      page.style.maxWidth = '297mm';
      page.style.maxHeight = '210mm';
      page.style.width = '297mm';
      page.style.height = '210mm';
      if (container) container.style.overflow = 'visible';

      whenImagesLoaded(page).then(function() {
        return new Promise(function(r) { requestAnimationFrame(function() { requestAnimationFrame(r); }); });
      }).then(function() {
        var opt = {
          margin: 0,
          filename: 'Improve-Me-Trading-Academy-One-Pager.pdf',
          image: { type: 'png', quality: 1 },
          html2canvas: {
            scale: 4,
            useCORS: true,
            letterRendering: true,
            logging: false,
            backgroundColor: '#0a1628'
          },
          jsPDF: {
            unit: 'mm',
            format: 'a4',
            orientation: 'landscape',
            compress: false,
            hotfixes: ['px_scaling']
          }
        };

        return html2pdf().set(opt).from(page).save();
      }).then(function() {
        page.style.transform = savedTransform;
        page.style.maxWidth = savedMaxWidth;
        page.style.maxHeight = savedMaxHeight;
        page.style.width = '';
        page.style.height = '';
        if (container) container.style.overflow = savedContainerOverflow;
        btn.disabled = false;
        btn.innerHTML = '<i class="fa-solid fa-file-pdf"></i> Download PDF';
      }).catch(function(err) {
        page.style.transform = savedTransform;
        page.style.maxWidth = savedMaxWidth;
        page.style.maxHeight = savedMaxHeight;
        page.style.width = '';
        page.style.height = '';
        if (container) container.style.overflow = savedContainerOverflow;
        btn.disabled = false;
        btn.innerHTML = '<i class="fa-solid fa-file-pdf"></i> Download PDF';
        console.error('PDF export error:', err);
        alert('PDF export failed. Please try again or use Print to PDF.');
      });
    });
  </script>
</body>
</html>
